import matplotlib
matplotlib.use('Agg')
import matplotlib.pyplot as plt

# classical SGD
C_SGD_BS256_FP16 = [21.52, 39.01, 43.79, 49.42, 54.92, 63.59, 65.61, 68.51, 64.12, 66.65, 74.82, 72.51, 73.58, 76.84, 78.11, 80.91, 80.8, 82.6, 80.62, 81.75, 84.83, 85.02, 83.66, 85.07, 84.19, 86.76, 85.25, 86.62, 85.82, 85.2, 86.93, 86.35, 86.85, 88.15, 86.7, 87.58, 88.13, 87.14, 87.95, 87.04, 87.91, 87.71, 87.86, 88.57, 89.23, 89.3, 88.2, 88.86, 88.57, 87.34, 89.01, 88.27, 89.05, 89.18, 87.95, 89.75, 88.46, 89.92, 88.63, 89.54, 89.33, 88.29, 88.88, 88.27, 86.8, 89.31, 87.52, 89.5, 89.15, 89.22, 89.62, 89.73, 88.28, 89.14, 89.12, 87.89, 88.41, 88.96, 88.96, 89.16, 89.13, 89.54, 89.84, 89.9, 90.05, 89.8, 88.57, 89.32, 89.56, 90.49, 89.7, 90.81, 89.6, 89.9, 89.9, 89.81, 89.66, 89.68, 89.23, 89.96]

C_SGD_BS256_FP32 = [38.58, 47.35, 56.36, 58.54, 66.33, 70.02, 67.4, 68.17, 71.62, 75.31, 74.97, 80.08, 78.27, 81.56, 77.33, 83.6, 83.75, 86.14, 84.1, 84.82, 86.5, 86.8, 86.02, 87.75, 84.9, 87.97, 88.38, 87.9, 88.76, 88.8, 88.63, 87.56, 89.08, 88.3, 89.04, 88.07, 88.86, 89.25, 88.86, 88.81, 88.83, 88.76, 89.13, 88.26, 89.76, 89.14, 89.51, 89.61, 89.51, 89.84, 89.01, 89.61, 87.02, 89.63, 88.78, 89.09, 89.59, 89.94, 88.84, 89.25, 88.49, 88.99, 89.87, 90.33, 89.93, 89.04, 89.41, 88.09, 90.16, 89.98, 89.22, 88.82, 89.28, 90.69, 90.58, 89.89, 90.61, 89.56, 90.53, 89.83, 90.24, 90.36, 88.38, 90.38, 90.7, 90.8, 90.6, 90.56, 89.99, 90.27, 89.45, 90.12, 90.64, 90.44, 91.06, 90.21, 90.58, 90.66, 90.31, 91.3]

C_SGD_BS128_FP32 = [34.18, 43.73, 49.38, 57.92, 65.23, 67.38, 69.88, 73.45, 77.38, 77.82, 81.41, 81.33, 81.23, 82.68, 83.09, 84.67, 83.36, 85.44, 84.21, 85.21, 85.04, 86.11, 85.7, 86.61, 86.68, 86.32, 86.83, 87.45, 86.95, 87.01, 85.82, 85.85, 88.44, 86.66, 87.62, 87.13, 87.68, 87.63, 87.32, 87.32, 87.06, 88.55, 87.3, 87.62, 87.46, 87.47, 88.7, 87.89, 88.68, 88.61, 87.71, 90.04, 88.5, 88.22, 88.02, 89.16, 87.84, 89.17, 86.25, 89.35, 89.38, 89.23, 87.83, 87.9, 88.88, 88.23, 88.24, 87.92, 88.7, 89.68, 89.3, 88.44, 89.16, 89.82, 89.97, 89.41, 87.96, 89.34, 89.14, 89.03, 89.29, 89.36, 88.71, 88.23, 88.93, 88.21, 88.12, 89.13, 89.56, 88.82, 88.8, 89.14, 90.38, 88.43, 89.36, 90.36, 89.03, 88.48, 88.82, 88.33]

C_SGD_BS128_FP16 = [43.38, 48.46, 61.66, 65.36, 67.85, 72.36, 75.97, 79.4, 80.33, 80.31, 81.89, 83.12, 84.14, 85.69, 84.78, 85.44, 84.99, 86.05, 86.38, 85.85, 87.11, 85.7, 87.17, 84.27, 87.97, 87.19, 87.57, 88.41, 88.16, 88.66, 85.83, 86.95, 88.06, 87.88, 88.37, 88.77, 88.29, 88.34, 88.66, 88.8, 87.76, 88.67, 90.29, 88.72, 88.02, 89.68, 88.74, 88.72, 88.34, 89.65, 88.44, 89.4, 89.15, 88.17, 88.43, 89.82, 89.92, 89.56, 87.97, 89.93, 87.62, 88.97, 88.91, 89.92, 89.39, 89.21, 89.39, 89.87, 87.28, 90.7, 90.36, 89.5, 89.36, 89.49, 90.24, 90.26, 89.35, 89.72, 89.78, 89.82, 90.3, 90.66, 89.2, 90.44, 89.72, 90.24, 88.72, 88.72, 90.8, 90.14, 89.53, 88.64, 87.14, 88.91, 89.69, 91.01, 89.47, 89.54, 89.18, 90.0]

# federated learning
FL_BS256_FP32 = [22.459999084472656, 50.720001220703125, 55.56999969482422, 61.93000030517578, 65.75, 69.08000183105469, 71.36000061035156, 75.19000244140625, 74.47000122070312, 78.19000244140625, 78.12000274658203, 80.45999908447266, 80.44999694824219, 79.94000244140625, 82.61000061035156, 82.7699966430664, 80.80000305175781, 82.06999969482422, 83.98999786376953, 83.20999908447266, 82.7699966430664, 85.12999725341797, 84.55000305175781, 84.56999969482422, 84.41000366210938, 86.95999908447266, 86.37000274658203, 85.38999938964844, 86.19000244140625, 86.29000091552734, 86.93000030517578, 87.36000061035156, 87.47000122070312, 87.66000366210938, 87.58999633789062, 86.20999908447266, 87.27999877929688, 86.86000061035156, 85.52999877929688, 86.83000183105469, 88.47000122070312, 87.93000030517578, 88.66999816894531, 88.41000366210938, 88.69000244140625, 88.72000122070312, 88.38999938964844, 88.76000213623047, 88.97000122070312, 88.63999938964844, 89.1500015258789, 89.37000274658203, 89.75, 89.02999877929688, 89.0999984741211, 89.37999725341797, 89.97000122070312, 88.83999633789062, 90.22000122070312, 89.80000305175781, 89.8499984741211, 89.86000061035156, 88.3499984741211, 89.61000061035156, 90.36000061035156, 89.91000366210938, 90.2300033569336, 89.80999755859375, 90.0999984741211, 88.33000183105469, 89.83999633789062, 90.12000274658203, 89.48999786376953, 90.77999877929688, 89.6500015258789, 90.37999725341797, 90.5, 90.26000213623047, 90.30999755859375, 90.5199966430664, 90.37000274658203, 91.0, 90.12000274658203, 89.69000244140625, 90.69000244140625, 90.80000305175781, 90.70999908447266, 91.02999877929688, 90.76000213623047, 90.62000274658203, 90.5, 90.69999694824219, 89.94999694824219, 90.69999694824219, 90.29000091552734, 90.36000061035156, 90.4000015258789, 90.4800033569336, 91.08999633789062, 90.6500015258789]
FL_BS256_FP16 = [30.350000381469727, 46.83000183105469, 56.06999969482422, 59.68000030517578, 66.94999694824219, 68.66000366210938, 71.23999786376953, 73.4800033569336, 75.06999969482422, 76.76000213623047, 76.31999969482422, 79.25, 79.33999633789062, 80.12000274658203, 82.08999633789062, 81.25, 82.55000305175781, 82.73999786376953, 84.41999816894531, 84.12999725341797, 83.37000274658203, 85.4000015258789, 84.4800033569336, 84.94000244140625, 85.33000183105469, 86.79000091552734, 86.2699966430664, 86.9000015258789, 86.58000183105469, 86.2699966430664, 86.88999938964844, 86.75, 85.66000366210938, 86.66999816894531, 86.6500015258789, 88.22000122070312, 88.0, 87.7300033569336, 88.0999984741211, 88.48999786376953, 88.3499984741211, 87.04000091552734, 88.38999938964844, 89.2300033569336, 88.8499984741211, 88.30000305175781, 87.5999984741211, 88.22000122070312, 88.91999816894531, 89.0199966430664, 89.16000366210938, 89.43000030517578, 89.72000122070312, 89.73999786376953, 89.9800033569336, 88.05999755859375, 89.51000213623047, 90.30999755859375, 90.45999908447266, 89.30999755859375, 89.66999816894531, 89.29000091552734, 90.37000274658203, 90.12999725341797, 90.27999877929688, 89.43000030517578, 90.44000244140625, 90.13999938964844, 89.97000122070312, 89.91000366210938, 90.55999755859375, 90.37999725341797, 90.47000122070312, 90.12999725341797, 90.38999938964844, 90.45999908447266, 90.54000091552734, 90.29000091552734, 89.55000305175781, 90.91000366210938, 90.0999984741211, 90.54000091552734, 90.61000061035156, 90.7300033569336, 91.05000305175781, 90.62000274658203, 91.08000183105469, 90.66000366210938, 90.58000183105469, 91.0199966430664, 90.44000244140625, 90.83000183105469, 90.7300033569336, 90.63999938964844, 90.9000015258789, 91.12000274658203, 91.11000061035156, 91.33999633789062, 91.12999725341797, 90.76000213623047]

FL_BS128_FP32 = [20.299999237060547, 51.4900016784668, 61.31999969482422, 66.31999969482422, 68.76000213623047, 71.91000366210938, 75.30999755859375, 77.63999938964844, 79.41999816894531, 80.44000244140625, 81.70999908447266, 82.69000244140625, 82.80000305175781, 81.76000213623047, 84.2699966430664, 83.44999694824219, 85.33999633789062, 85.80999755859375, 85.62999725341797, 85.86000061035156, 86.9800033569336, 87.20999908447266, 86.97000122070312, 85.58000183105469, 87.7699966430664, 87.44999694824219, 88.36000061035156, 88.41999816894531, 87.69999694824219, 88.6500015258789, 88.55999755859375, 88.44999694824219, 88.5199966430664, 89.31999969482422, 89.30000305175781, 89.38999938964844, 88.87000274658203, 89.69000244140625, 90.02999877929688, 90.02999877929688, 89.73999786376953, 89.66999816894531, 90.18000030517578, 90.5199966430664, 90.5199966430664, 90.36000061035156, 90.55999755859375, 90.70999908447266, 89.80999755859375, 90.43000030517578, 90.58000183105469, 90.76000213623047, 90.1500015258789, 88.73999786376953, 90.81999969482422, 90.91000366210938, 91.02999877929688, 90.91999816894531, 91.4800033569336, 91.4800033569336, 91.16999816894531, 89.94000244140625, 91.0199966430664, 90.9800033569336, 91.30000305175781, 91.26000213623047, 91.47000122070312, 91.47000122070312, 91.51000213623047, 91.33999633789062, 91.69000244140625, 91.3499984741211, 91.22000122070312, 91.61000061035156, 91.58000183105469, 91.08000183105469, 91.45999908447266, 91.86000061035156, 91.37999725341797, 91.69000244140625, 91.87999725341797, 91.70999908447266, 92.18000030517578, 91.95999908447266, 92.26000213623047, 91.75, 91.4000015258789, 92.0199966430664, 92.37999725341797, 92.11000061035156, 91.1500015258789, 92.52999877929688, 92.38999938964844, 91.97000122070312, 91.91999816894531, 91.83000183105469, 92.20999908447266, 92.12000274658203, 92.19000244140625, 92.44000244140625]
# FL_BS128_FP16 = [25.600000381469727, 54.22999954223633, 63.08000183105469, 66.70999908447266, 69.72000122070312, 73.87999725341797, 74.80999755859375, 77.97000122070312, 79.93000030517578, 80.69999694824219, 81.66999816894531, 80.27999877929688, 83.13999938964844, 84.2699966430664, 84.0199966430664, 84.5, 85.38999938964844, 84.54000091552734, 85.52999877929688, 86.19999694824219, 86.30000305175781, 86.19000244140625, 87.4800033569336, 87.22000122070312, 87.6500015258789, 87.75, 87.66999816894531, 87.73999786376953, 87.83000183105469, 87.44000244140625, 88.87000274658203, 88.12999725341797, 88.95999908447266, 88.72000122070312, 89.1500015258789, 89.18000030517578, 89.81999969482422, 89.18000030517578, 89.12000274658203, 88.87999725341797, 89.4800033569336, 89.77999877929688, 89.83000183105469, 89.62000274658203, 90.31999969482422, 90.37999725341797, 90.30999755859375, 90.83000183105469, 90.7300033569336, 90.4000015258789, 90.8499984741211, 91.01000213623047, 90.98999786376953, 90.55000305175781, 90.33999633789062, 90.75, 90.94000244140625, 91.12999725341797, 90.69000244140625, 91.11000061035156, 91.18000030517578, 90.70999908447266, 91.61000061035156, 91.36000061035156, 91.33999633789062, 90.66999816894531, 90.66000366210938, 91.58999633789062, 91.70999908447266, 91.25, 91.11000061035156, 91.01000213623047, 91.7300033569336, 91.3499984741211, 91.16000366210938, 91.45999908447266, 91.05999755859375, 91.0999984741211, 91.66999816894531, 91.73999786376953, 91.76000213623047, 91.08999633789062, 91.94999694824219, 91.80999755859375, 91.23999786376953, 91.62000274658203, 91.69000244140625, 92.12000274658203, 91.4000015258789, 91.7699966430664, 92.05999755859375, 92.12999725341797, 92.01000213623047, 91.55999755859375, 92.30000305175781, 92.20999908447266, 91.5, 92.16000366210938, 91.87999725341797, 92.11000061035156]

# FL_BS32_FP32 = [13.880000114440918, 43.15999984741211, 57.0, 64.5999984741211, 68.43000030517578, 72.41999816894531, 74.52999877929688, 76.83999633789062, 78.7699966430664, 80.05000305175781, 79.12999725341797, 81.3499984741211, 83.0999984741211, 83.2699966430664, 84.51000213623047, 84.73999786376953, 85.12000274658203, 85.72000122070312, 85.83000183105469, 86.62999725341797, 86.44999694824219, 86.61000061035156, 87.26000213623047, 86.95999908447266, 88.06999969482422, 88.5199966430664, 88.0999984741211, 88.76000213623047, 89.04000091552734, 89.27999877929688, 88.69000244140625, 89.36000061035156, 89.70999908447266, 89.52999877929688, 90.08999633789062, 90.16999816894531, 90.08000183105469, 89.94999694824219, 90.51000213623047, 90.4000015258789, 90.58000183105469, 90.44999694824219, 90.69999694824219, 90.95999908447266, 90.83999633789062, 91.20999908447266, 91.47000122070312, 91.12999725341797, 91.37999725341797, 91.41999816894531, 91.36000061035156, 91.54000091552734, 91.7300033569336, 91.61000061035156, 91.33999633789062, 91.3499984741211, 91.5999984741211, 92.05000305175781, 91.94999694824219, 91.83999633789062, 92.1500015258789, 91.88999938964844, 91.8499984741211, 92.11000061035156, 91.91000366210938, 92.13999938964844, 92.08999633789062, 92.23999786376953, 92.33999633789062, 92.41000366210938, 92.55999755859375, 92.3499984741211, 92.55999755859375, 92.2300033569336, 92.58999633789062, 92.4800033569336, 92.18000030517578, 92.69000244140625, 92.58999633789062, 92.58999633789062, 92.76000213623047, 92.63999938964844, 92.80000305175781, 92.73999786376953, 93.0, 92.88999938964844, 92.66000366210938, 92.7300033569336, 93.11000061035156, 93.0199966430664, 93.01000213623047, 92.91999816894531, 92.62999725341797, 93.0999984741211, 92.8499984741211, 93.44999694824219, 92.98999786376953, 92.8499984741211, 92.94999694824219, 92.94999694824219]
# FL_BS32_FP16 = [10.579999923706055, 46.13999938964844, 57.0099983215332, 63.02000045776367, 67.80000305175781, 70.62999725341797, 72.58999633789062, 75.61000061035156, 78.33000183105469, 79.05000305175781, 81.30000305175781, 81.45999908447266, 83.11000061035156, 83.13999938964844, 84.66000366210938, 84.0999984741211, 84.8499984741211, 85.77999877929688, 85.3499984741211, 85.8499984741211, 86.81999969482422, 87.36000061035156, 87.5199966430664, 87.76000213623047, 88.13999938964844, 88.0199966430664, 88.5, 88.4800033569336, 88.87000274658203, 89.2300033569336, 89.2699966430664, 89.44000244140625, 90.0, 89.6500015258789, 90.12999725341797, 89.44000244140625, 90.05000305175781, 90.30999755859375, 90.5, 90.61000061035156, 90.4800033569336, 90.52999877929688, 90.66999816894531, 90.88999938964844, 91.05000305175781, 90.94999694824219, 90.94999694824219, 91.25, 91.36000061035156, 91.36000061035156, 91.37999725341797, 91.4800033569336, 91.26000213623047, 91.72000122070312, 91.81999969482422, 92.0199966430664, 91.62999725341797, 92.22000122070312, 92.13999938964844, 92.12999725341797, 92.48999786376953, 92.02999877929688, 91.80000305175781, 92.2300033569336, 92.31999969482422, 92.19000244140625, 92.18000030517578, 92.41999816894531, 92.26000213623047, 92.66000366210938, 92.20999908447266, 92.37000274658203, 92.68000030517578, 92.66999816894531, 92.55000305175781, 92.7699966430664, 92.58000183105469, 92.12000274658203, 92.44000244140625, 92.30999755859375, 92.5, 92.5199966430664, 92.58999633789062, 92.77999877929688, 92.55999755859375, 92.7699966430664, 92.75, 92.83999633789062, 92.97000122070312, 92.9000015258789, 92.88999938964844, 92.5999984741211, 92.98999786376953, 92.79000091552734, 92.58000183105469, 92.61000061035156, 92.94999694824219, 92.77999877929688, 92.9800033569336, 92.83999633789062]

# distributed SGD
D2_SGD_BS128_FP32 = [38.76, 45.67, 51.37, 54.61, 61.3, 59.69, 61.85, 64.59, 67.84, 68.17, 76.41, 75.27, 76.3, 77.69, 78.81, 80.17, 81.5, 81.81, 81.78, 82.94, 84.45, 84.12, 85.04, 84.14, 83.79, 83.88, 84.57, 86.62, 85.08, 85.73, 84.29, 85.27, 86.64, 84.81, 86.26, 85.66, 85.34, 85.51, 84.77, 86.93, 86.01, 86.47, 87.26, 87.1, 87.99, 86.12, 87.0, 86.44, 87.19, 87.8, 87.54, 86.3, 87.46, 88.66, 87.65, 87.53, 87.04, 88.64, 87.24, 88.54, 88.17, 88.96, 88.4, 87.88, 88.61, 87.46, 87.89, 87.36, 86.32, 87.45, 88.43, 87.92, 89.07, 87.87, 87.65, 88.75, 88.13, 88.34, 89.57, 88.25, 88.96, 89.27, 87.21, 87.96, 87.85, 88.45, 88.48, 88.58, 86.86, 88.54, 88.31, 88.93, 86.91, 87.91, 88.04, 88.95, 88.38, 88.9, 88.78, 89.63]
D2_SGD_BS128_FP16 = [43.54, 54.21, 61.85, 68.88, 72.84, 76.1, 76.29, 79.64, 78.12, 80.52, 83.21, 82.38, 83.74, 84.58, 84.53, 83.87, 85.92, 84.57, 85.1, 86.7, 85.64, 85.09, 85.05, 84.89, 86.08, 85.46, 86.07, 86.78, 85.19, 84.84, 87.0, 87.26, 85.08, 87.93, 88.2, 87.38, 88.96, 86.68, 86.9, 88.3, 88.11, 88.59, 85.93, 88.55, 89.05, 88.2, 87.81, 87.83, 87.84, 87.47, 88.44, 87.59, 88.37, 88.98, 89.18, 87.8, 89.62, 88.19, 86.87, 88.95, 88.88, 88.95, 89.1, 87.85, 87.94, 89.56, 89.12, 89.45, 87.89, 88.9, 87.73, 90.02, 89.67, 89.35, 88.67, 85.49, 88.37, 88.69, 89.56, 88.8, 89.77, 88.45, 89.11, 89.66, 88.62, 89.76, 89.61, 89.49, 89.79, 88.38, 88.03, 89.97, 89.34, 89.78, 89.34, 89.44, 89.79, 89.66, 89.39, 89.96]

D4_SGD_BS256_FP32 = [35.16, 44.66, 51.66, 57.92, 61.27, 63.59, 69.54, 71.14, 74.55, 75.28, 79.04, 77.17, 79.55, 80.32, 82.12, 83.78, 82.63, 84.62, 83.64, 84.19, 85.22, 85.37, 85.81, 85.54, 85.28, 86.92, 86.85, 85.92, 86.85, 86.4, 85.88, 88.01, 87.66, 87.89, 86.61, 87.53, 87.97, 88.46, 87.62, 88.64, 88.02, 87.65, 88.03, 88.22, 88.4, 88.82, 88.18, 87.65, 87.72, 87.98, 88.92, 88.22, 88.61, 88.53, 88.91, 87.24, 89.21, 88.93, 88.79, 89.31, 88.9, 89.21, 89.4, 88.85, 89.11, 88.68, 88.55, 87.36, 89.08, 90.45, 88.99, 90.09, 88.61, 89.88, 89.51, 89.82, 89.33, 88.55, 89.82, 88.56, 88.32, 89.62, 89.33, 90.07, 89.36, 89.69, 88.67, 89.43, 89.73, 88.93, 89.7, 90.17, 89.29, 89.69, 89.54, 90.24, 90.08, 89.56, 89.43, 89.95]
D4_SGD_BS256_FP16 = [40.72, 48.0, 59.11, 64.27, 67.93, 70.18, 75.18, 74.84, 77.25, 80.05, 80.64, 82.14, 83.74, 84.17, 84.15, 82.94, 84.6, 85.18, 85.69, 86.78, 86.15, 86.8, 86.0, 86.59, 87.95, 86.1, 87.77, 88.1, 87.49, 88.71, 88.15, 88.36, 88.84, 88.4, 88.11, 88.0, 88.22, 88.32, 88.49, 88.09, 87.87, 88.86, 88.38, 88.85, 88.55, 89.08, 88.94, 88.61, 88.97, 89.46, 89.07, 88.42, 88.29, 88.94, 90.14, 89.11, 89.12, 87.34, 90.17, 86.11, 89.48, 90.4, 88.27, 88.9, 87.14, 89.44, 89.24, 89.55, 88.22, 85.74, 88.33, 89.09, 88.78, 89.33, 90.45, 89.21, 88.37, 90.41, 89.39, 89.8, 89.1, 89.25, 89.74, 89.72, 89.38, 89.66, 90.35, 89.43, 89.81, 88.2, 88.55, 90.08, 90.51, 88.93, 90.16, 88.85, 88.63, 89.43, 89.11, 89.47]

D2_SGD_BS2048_FP16 = [14.41, 26.31, 44.59, 46.84, 47.82, 55.09, 52.32, 58.34, 64.99, 66.29, 66.94, 66.92, 60.99, 73.0, 68.63, 72.69, 69.16, 78.12, 75.75, 79.22, 78.81, 74.68, 77.89, 80.96, 78.91, 80.12, 79.23, 81.88, 79.42, 81.48, 80.63, 82.89, 78.62, 74.98, 77.12, 76.68, 82.65, 73.26, 79.6, 75.76, 74.35, 75.66, 74.22, 58.16, 82.97, 77.88, 80.59, 78.59, 80.68, 81.64, 82.61, 85.17, 83.39, 82.31, 78.22, 74.63, 79.64, 83.05, 81.43, 78.88, 80.06, 83.38, 81.79, 84.21, 84.56, 80.21, 83.72, 80.1, 78.01, 77.14, 78.04, 79.51, 75.97, 81.87, 84.66, 82.39, 79.18, 82.45, 80.94, 82.31, 80.29, 84.42, 79.08, 76.54, 74.97, 80.34, 83.4, 84.58, 84.96, 82.21, 77.89, 85.62, 79.74, 73.0, 85.6, 83.26, 82.33, 74.12, 83.23, 79.72]
D2_SGD_BS2048_FP32 = [10.89, 19.65, 21.92, 21.32, 27.36, 34.67, 38.65, 42.52, 44.73, 48.53, 47.73, 45.96, 55.48, 58.92, 61.02, 51.64, 63.75, 66.71, 65.9, 69.36, 67.88, 67.69, 70.35, 70.88, 70.28, 72.49, 74.81, 74.68, 73.21, 76.03, 75.75, 76.05, 73.83, 77.29, 78.75, 79.51, 81.47, 82.02, 80.61, 81.94, 81.63, 80.75, 81.48, 78.88, 81.57, 81.54, 80.75, 81.17, 80.58, 84.33, 79.12, 82.94, 79.8, 80.88, 84.16, 84.04, 83.27, 84.64, 83.52, 82.94, 81.91, 81.62, 82.76, 85.22, 84.38, 85.33, 84.02, 85.92, 83.83, 85.89, 85.55, 84.58, 84.21, 85.08, 84.89, 82.4, 81.1, 84.73, 84.22, 85.42, 87.42, 85.42, 84.97, 85.53, 85.6, 86.78, 87.18, 86.45, 85.41, 86.88, 86.27, 86.63, 86.39, 85.1, 87.51, 86.27, 86.86, 85.87, 86.02, 88.3]

# Plot
plt.figure()
plt.plot(range(100), C_SGD_BS256_FP32, range(100), D4_SGD_BS256_FP32, range(100), D2_SGD_BS2048_FP32, range(100), FL_BS256_FP32)
plt.xlabel('#Epoch')
plt.ylabel('Test Accuracy (%)')
plt.title('ResNet18 Classification on CIFAR10')
plt.legend(['C_SGD_BS256_FP32', 'D_SGD_BS256_FP32', 'D_SGD_BS2048_FP32', 'FL_BS256_FP32'])
plt.savefig('./Perf_cifar10_ResNet1_{}.png'.format( 'FP32'))

plt.figure()
plt.plot(range(100), C_SGD_BS256_FP16, range(100), D4_SGD_BS256_FP16, range(100), D2_SGD_BS2048_FP16, range(100), FL_BS256_FP16)
plt.xlabel('#Epoch')
plt.ylabel('Test Accuracy (%)')
plt.title('ResNet18 Classification on CIFAR10')
plt.legend(['C_SGD_BS256_FP16', 'D_SGD_BS256_FP16', 'D_SGD_BS2048_FP16', 'FL_BS256_FP16'])
plt.savefig('./Perf_cifar10_ResNet1_{}.png'.format( 'FP16'))
